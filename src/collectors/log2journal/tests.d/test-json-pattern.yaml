# Test JSON pattern parsing
pattern: json

inject:
  - key: SOURCE
    value: "json-parser"

rewrite:
  # Normalize timestamp formats
  - key: _TIMESTAMP
    match: "(\\d{4})-(\\d{2})-(\\d{2})\\s+(\\d{2}):(\\d{2}):(\\d{2})"
    value: "${1}${2}${3}T${4}${5}${6}Z"

  # Extract nested fields using variables
  - key: USER_ID
    value: "${USER_ID}"
    inject: yes

  - key: USER_NAME
    value: "${USER_NAME}"
    inject: yes

  # Handle arrays
  - key: FIRST_TAG
    value: "${TAGS_0}"
    inject: yes

rename:
  - old_key: _TIMESTAMP
    new_key: TIMESTAMP
  - old_key: _VERSION
    new_key: VERSION
